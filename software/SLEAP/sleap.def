Bootstrap: docker
From: condaforge/miniforge3:latest

%post
        # Install some shared library requirements
        export DEBIAN_FRONTEND=noninteractive
        apt update -y
        apt install -y ffmpeg libsm6 libxext6 libc6 git

        # Install Sleap from git
        git clone https://github.com/talmolab/sleap && cd sleap
        mamba env create -f environment.yml -n sleap

        # Activate environment when starting container
        cat << EOF > $APPTAINER_ENVIRONMENT
source /opt/conda/bin/activate
conda activate sleap
EOF
